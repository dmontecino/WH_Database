<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>source_source_records</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="source_source_records_files/libs/clipboard/clipboard.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/quarto.js"></script>
<script src="source_source_records_files/libs/quarto-html/popper.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/anchor.min.js"></script>
<link href="source_source_records_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="source_source_records_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="source_source_records_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="source_source_records_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="source_source_records_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<!-- # Source and Source Records {.unnumbered} -->
<section id="general-overview" class="level3">
<h3 class="anchored" data-anchor-id="general-overview">General Overview</h3>
<p>In the data model, a <strong>Source</strong> is a unit that can be observed and provide <strong>Specimens</strong> for analysis or whose observation at time <em>t</em> is used in a diagnostic test (e.g., full <em>Animal</em> for an MRI). <strong>Sources</strong> can provide between zero up (e.g., observation only) to indefinite number of <strong>Specimens</strong> to conduct <strong>Diagnostic</strong> tests. The data model manages four types of <strong>Sources</strong>: i) a co-specific group of animals (<em>Group</em>), ii) individual animals (<em>Animal</em>), iii) sites that can provide abiotic tissue of interest or biotic material of animal origin whose individual or group animal of origin is unknown (<em>Environmental</em>), and iv) sites where arthropods are obtained from (<em>Arthropod</em>). A <strong>Group Source</strong> could correspond to a specific bat roost of species X sourcing guano, an <strong>Animal Source</strong> could be a collared animal, an <strong>Environmental Source</strong> could be a pond where water is collected from or feces found in the field whose animal of origin is unknown, and an <strong>Arthropod Source</strong> could be a site where mosquito larvae are collected from. Sources contain time-independent data only, such as the species of an animal in the case of a <em>Group</em> or <em>Animal</em> Sources (more below).</p>
<p>All <strong>Sources</strong> can potentially be identified and tracked over time if needed. However, there are limitations, <em>Environmental</em> and <em>Arthropod</em> <strong>Sources</strong> are site-specific, making them easier to track across different time points. <em>Animal</em> and <em>Group</em> <strong>Sources</strong> may not always be individually identifiable, which can prevent tracking them over time.</p>
<p>**A Source collected, or captured at time <em>t</em> can be linked to Events through a Collection (see previous section) via a Source Record (the Source at time <em>t</em>), which represents the Source at a specific time <em>t<strong>. </strong>Source Records<strong> contain only time-dependent data, such as health status at time <em>t</em> for </strong>Group</em> and *Animal Sources**.</p>
<p><strong>Individually identified Sources can tracked across multiple Events, even across different Surveillance Activities</strong>. For example, a bat (<strong>Source</strong>) captured in a mist net (<strong>Collection</strong>) deployed at a roost at time <em>t</em> (<strong>Event</strong>), individually identified, and later recaptured in another <strong>Event</strong> <em>t′</em>. This bat is linked to both the original capture <strong>Event</strong> and the recapture <strong>Event</strong>, with a unique <strong>Source Record</strong> for each occurrence.</p>
<p><strong>Sources that are not identified will be linked as a Source Record to the Event where they were observed or captured only</strong>. For example, a bat (Source) that is captured (Collection) and sampled during an Event but not marked or a dead animal not identified found by a ranger during a patrol. The bat and the animal found are linked only to the Event they were capture and observed, respectively.</p>
<p><strong>Sources found opportunistically are still linked to an Event, even if no formal Collection occurred</strong>. For example, a member of the public reports a dead animal (<strong>Source Record</strong>) found on a beach at time <em>t</em> (<strong>Event</strong>).</p>
</section>
<section id="group-source" class="level3">
<h3 class="anchored" data-anchor-id="group-source">Group Source</h3>
<p><strong>A Group Source is a unit of co-specific individuals (animals of the same species) associated to a herd, an area, a site, a farm, a cage, a stall, an enclosure, or other that makes the individuals part a single epidemiological unit</strong>. Group Sources can be observed, captured, and provide Specimens at time <em>t</em> as a collective. Data of a Group Source include the Species, the Group Source ID, the Group Source Cross Reference ID, among others (see Data Dictionary).</p>
<p>The purpose of Group Source is to record individuals at the species level instead of individual by individual. This can occur when herds are the unit of interest, when protected area rangers find animals of the same species in a health event, or to document animals in a unit such as a cage, stall, or vendor of a market. For example, animals of two species in a single cage, not tracked individually, represent two Group Sources (one Group Source by species).</p>
<section id="group-source-record" class="level4">
<h4 class="anchored" data-anchor-id="group-source-record">Group Source Record</h4>
<p><strong>A Group Source Record consists of a count of the animals in the Group Source at time <em>t</em>, stratified by sex, age, and health status (e.g., healthy, injured, sick, or dead)</strong>. Other properties of the Group Source Record are Observed Anomalies, Potential Causes of Disease or Death if they apply at time <em>t</em>, among others (see Data Dictionary). Properties of a Group Source Record are documented at the group level, therefore, multiple options can be reported. For example, a Group Source with three dead animals can receive several potential causes of death. <strong>It is not possible to know the distribution of the potential causes of death and other properties across individuals of a Group Source Record</strong>, but only that they were present in at least one individual.</p>
<p><strong>Group Source Records can include a mix of dead, diseased, poisoned, infected, injured, and healthy individuals of the same species or just one of them if all the animals of the species are dead</strong>. A Group Source Record of only healthy animals can also be part of a Health Event depending on the definition of Event.</p>
<p><strong>Group Source Records can have a single individual</strong>. For example, rangers patrolling a protected area might find a dead animal of species X and two dead animals of species Y at the same site (Event) and rangers record their animal data as Group Sources. If this is the case, the single animal of species X belong to a Group Source Record and the two animals of species Y correspond to another Source Group Record. Moreover, if only a single animal of a known herd is observed at time <em>t</em>, then that individual is the representation of the herd for the Source Group Record.</p>
<p><strong>An Event can have more than one Group Source Record of the same species</strong>. For example, animals of the same species in two cages hold by a vendor in market where the vendor is considered an Event. Then the animals per cage could be a unit, and therefore, two Group Source Records of the same species under the same vendor (same Event).</p>
<p><strong>An Group Source can be used directly for a Diagnostic</strong> (e.g., assessment of the body condition of a specific herd). The data model can accommodate Diagnostics applied to a group itself rather than a Specimen taken from that Group Source. <strong>Specimens (see below) from Group Sources can be stored, exported, and they can be used for Diagnostics</strong> (see below). However, **the data model does not accept Group Sources Carcasses to be exported or stored as a set of Carcasses because their collection and manipulation implies an opportunity to collect data at the individual level (Animal Source). Similar criteria applies with Necropsies and the Specimens collected from these Carcasses. In this case, the animals of the Group Source whose Carcasses are taken or used for field Necropsy can and MUST be converted to Animals Sources. These Animal Sources are identified as ex-members of a Group Source and their Carcasses, Necropsies, and Specimens are tight to the individual animal (more details in the Complexities section below).</p>
<p><strong>Group Sources cannot be taken from the field</strong>. If dead animals from a Group Source are taken from the field, each one of them must be documented as an Animal Source coming from the corresponding Group Source whose Carcass is collected (See ‘Animal Source’ and ‘Carcass’ below). <strong>Live animals of Group Sources cannot be taken ex-situ.</strong></p>
<p><strong>An animal of species X documented as part of a Group Source Record must not be included as an Animal Source Record and vice-versa</strong>. If an Event contains a Group Source Record of species X and an Animal Source Record of species X, then the total number of animals of species X at the Event is the sum of the number of animals of species X in the Group Source Record and the single individual of species X recorded as an Animal Source Record. An example is a herd of cows illegally raised in a protected area whose health is assessed at time <em>t</em>. The herd of this example contains 20 cows. Two of them are sampled and the rest are part of a single unit. In this case, the sampled cows can be added as two Animal Source Records (one per sampled cow) and the remaining 18 animals can be added as a single Group Source Record that distributes the animals per sex, age, and health status. The total number of cows are the individuals in the Group Source Record (18) and the two cows recorded as Animal Records. The “herd” identity of the 20 cows can be kept using a cluster (see “Complexities”). If the Group Source Record contains the original 20 cows and also two Animal Source Records, then the total number of cows will be 22.</p>
</section>
</section>
<section id="animal-source" class="level3">
<h3 class="anchored" data-anchor-id="animal-source">Animal Source</h3>
<p><strong>An Animal Source represents an individual animal whose specific individual-level data is of interest</strong>. Animal Sources can be observed, captured, tested, and provide Specimens at time <em>t</em>, including the full carcass to have a Necropsy completed. Animal Source data includes the Species, the Animal Source ID, the Cross Reference ID, the Sex, among others (see Data Dictionary). Past marking codes (if any have been used) are considered immutable and entered as data of the Animal Source.</p>
<p>An example of Animal Sources are animals of the same or different species caged in a live market. If the data of the animals is to be collected at the individual-level, then each individual in the cage represents an Animal Group Source.</p>
<section id="animal-source-record" class="level4">
<h4 class="anchored" data-anchor-id="animal-source-record">Animal Source Record</h4>
<p><strong>An Animal Source Record consists of an Animal Source at time <em>t</em> </strong>. Properties of an Animal Source Record are its Age, Health Status, Observed Anomalies, and Potential Cause of Disease or Death if they apply at time <em>t</em>, among others (see Data Dictionary). The current marking code of an individual animal at time <em>t</em> is considered mutable and a property of the corresponding Animal Source Record. Properties of an Animal Source Record can receive single or multiple choices. For example, the observed health status is only one (live healthy, live sick) but an Animal Source Record can receive several observed anomalies if they observed in the same individual at time <em>t</em> (wounded, hair loss, diarrhea, etc. See Data Dictionary).</p>
<p>An Animal Source can be either dead, diseased, poisoned, infected, injured, or healthy at time <em>t</em>. <strong>An Animal Source Record with an observed health status “live healthy” can be part of an Event depending on the Event definition</strong> (e.g., a healthy animal of species X next to dead animals of species X, Y, and Z; or healthy animals captured for Specimen collection).</p>
<p>An Animal Source Record can be used directly for a Diagnostic (e.g., X-rays in a live animal at time <em>t</em>). The data model can accommodate Diagnostics applied to the individual itself rather than a Specimen taken from that Animal Source.</p>
<p><strong>Live Animal Source cannot be taken ex-situ.</strong> Only Carcasses of Animal Source can be taken out of the field and stored in a facility.</p>
<p><strong>An animal of species X documented as part of a Group Source Record cannot be included as an Animal Source Record and vice versa</strong>. If an Event contains a Group Source Record of species X and an Animal Source Record of species X, then the total number of animals of species X at the Event is the sum of the number of animals of species X in the Group Source Record and the single individual of species X recorded as an Animal Source Record. An example is a herd of cows illegally raised in a protected area whose health is assessed at time <em>t</em>. The herd of this example contains 20 cows. Two of them are sampled and the rest are part of a single unit. In this case, the sampled cows can be added as two Animal Source Records (one per sampled cow) and the remaining 18 animals can be added as a single Group Source Record that distributes the animals per sex, age, and health status. The total number of cows are the individuals in the Group Source Record (18) and the two cows recorded as Animal Records. The “herd” identity of the 20 cows can be kept using a cluster (see “Complexities”). If the Group Source Record contains the original 20 cows and also two Animal Source Records, then the total number of cows will be 22.</p>
</section>
<section id="vaccination" class="level4">
<h4 class="anchored" data-anchor-id="vaccination">Vaccination</h4>
<p>The data model allows the inclusion of vaccinations completed in an Animal Source by the time it was captured or immobilized at time <em>t</em>. It is possible to include as many vaccination records as needed to an Animal Source Record. Thus, the vaccination data accumulates for the corresponding Animal Source.</p>
</section>
<section id="carcass" class="level4">
<h4 class="anchored" data-anchor-id="carcass">Carcass</h4>
<p>The carcass of a dead Animal Source can provide Specimens. A Carcass entered to the database comes from a specific Animal Source and they are collected at a single specific time <em>t</em>. Therefore, each Carcass is associated with one and only one Animal Source Record (when the Carcass was collected). Properties of a Carcass include its Decomposition Condition, Storage During Transport, Owner, Availability, among others. Moreover, Carcasses are stored and changes in the storage or movement of the Carcass from one storage facility to another can be multiple over time. Similarly, Carcasses can be exported multiple times. Changes in storage associated with an exportation must occur after the exportation is completed and the Carcass can be stored in the destination facility.</p>
<p>A Carcass does not provide Specimens directly but through the dead Animal Source Record. The Specimens can be identified as Carcass sourced.</p>
<p>A Carcass is not used directly for a Diagnostic but through the dead Animal Source Record (e.g., X-rays in a dead animal). The diagnostic information is part of the set of Diagnostics conducted in the corresponding Animal Source.</p>
</section>
<section id="necropsy" class="level4">
<h4 class="anchored" data-anchor-id="necropsy">Necropsy</h4>
<p>A Necropsy is associated with a specific Animal Source Carcass. <strong>The earliest date a Necropsy can occur is when the dead animal was found and a Field Necropsy was conducted (no Carcass collection) or after the Carcass was collected</strong>.</p>
<p>Necropsy data includes the a Necropsy Identifier, the Necropy Cross Reference Identifier, the Date of the Necropsy, findings per system, among others (see Data Dictionary).</p>
<p>Necropsies can be primary or secondary. A primary necropsy usually starts with an intact carcass (not previously used in a necropsy). A secondary necropsy is usually conducted by a veterinarian pathologist using pictures of the primary necropsy or using a carcass already necropsied.</p>
<p>A Necropsy does not provide Specimens directly but through the Animal Source Record.</p>
</section>
</section>
<section id="environmental-source" class="level3">
<h3 class="anchored" data-anchor-id="environmental-source">Environmental Source</h3>
<p><strong>An Environmental Source is a unit in space where Specimens that cannot be associated with a Group Source, an Animal Source, or Arthropod Source can be collected from</strong> (e.g., the site where feces of unknown source are found). Properties of an Environmental Source include the Environmental Source ID, the Cross Reference ID, among others (see Data Dictionary).</p>
<section id="environmental-source-record" class="level4">
<h4 class="anchored" data-anchor-id="environmental-source-record">Environmental Source Record</h4>
<p><strong>An Environmental Source Record is the biotic or abiotic tissue from the Environmental Source at time <em>t</em> recovered using a common Collection</strong>. For example, the water collected from a pond (Event) at site X (Environmental Source) using a device (Collection) to obtain water at time <em>t</em> (Environmental Source Record). Properties of an Environmental Source Record include Record Number, Type of Tissue, the Quantity, and the Quantity Unit (see Data Dictionary).</p>
<p><strong>A key difference between the Environmental Source and the Group and Animal Sources is that an Event can contain multiple Records of a single Environmental Source (many Collections from the same Environmental Source at time <em>t</em>). Instead, an Event can contain a single Record of many Group and Animal Sources (in one or many Collections)</strong>. An Event can only contain a single Environmental Source, but many Records can be retrieved (one per collection). On the opposite, many bats can be captured in a mist net (many Sources), but they can only provide one Record per Event (see figure at the end of this section).</p>
<p><strong>Another key difference is that “species” for Group and Animal Sources is a property of the Source, whilst for Environmental Sources is a property of the Record</strong>. For example, it could be possible to identify the species that dropped feces found in the field as “mammal”. If this is the case, then the Species property can be completed with this level of taxonomy.</p>
<p><strong>If there is a failed Collection of tissue at time <em>t</em> from the Environmental Source) then it is the Collection that exists without the Environmental Source Record. But an Environmental Source Record cannot be empty</strong>.</p>
</section>
</section>
<section id="arthropod-source" class="level3">
<h3 class="anchored" data-anchor-id="arthropod-source">Arthropod Source</h3>
<p><strong>An Arthropod Source is a unit in space where arthropods can be taken from</strong> (e.g., a household in the forest where traps can be set). Properties of an Arthropod Source include the Source ID, the Cross Reference ID, the Cross Reference ID Origin, among others (see Data Dictionary).</p>
<p><strong>If the interest of the Surveillance Activity is at the arthropod individual level (e.g., butterflies with problems in their wings or with parasites), then the user should consider these arthropods as Animal Sources. Arthropods from Animals Sources (attached ticks, lice, fleas, mites) are Specimens (see next section) from an Animal Source and not Arthropod Sources</strong>.</p>
<section id="arthropod-source-record" class="level4">
<h4 class="anchored" data-anchor-id="arthropod-source-record">Arthropod Source Record</h4>
<p><strong>An Arthropod Source Record is the arthropods of the same species collected at the Arthropod Source at time <em>t</em> using a common Collection</strong>. For example, the mosquitoes of species X collected (Event) at the household in the forest (Arthropod Source) at time <em>t</em> (Arthropod Source Record) using a specific type of trap (Collection). This means that <strong>mosquitoes of a specific species collected by CO2 traps deployed at the Arthropod Source at time <em>t</em> </strong> is an Arthropod Source Record and that mosquitoes of a specific species collected by any number of BG traps deployed at the Arthropod Source at time <em>t</em> is another Arthropod Source Record. The properties of an Arthropod Source Record include Record Number, Species, and the mosquitoes distributed by age, sex, and condition (females only), among others (see Data Dictionary).</p>
<p><strong>Similar to Environmental Sources, a key difference between the Arthropod Source and the Group and Animal Sources is that an Event can contain multiple Records of a single Arthropod Source (many Collections and many species at the same Arthropod Source at time <em>t</em>). Instead, an Event can contain a single Record of many Group and Animal Sources</strong>. An Event can only contain a single Arthropod Source, but many Records can be retrieved (one per Collection per species). On the opposite, many bats can be captured in a mist net (many Sources), but they can only provide one Record per Event (see Figure at the end of the section).</p>
<p><strong>Similarly, another key difference is that “species” for Group and Animal Sources is a property of the Source, whilst for Arthropod Sources is a property of the Record</strong>. For example, mosquitoes obtained through CO2 traps (Collection) deployed at a specific site (Source) will be identified and counted by species after the Collection and they will constitute an Arthropod Source Record.</p>
<p><strong>If there is a failed Collection of arthropods at time <em>t</em> from the Arthropod Source) then it is the Collection that exists without Arthropod Source Records. But an Arthropod Source Record cannot be empty</strong>.</p>
<p><img src="Pictures_and_diagrams/Picture23.png" class="img-fluid" width="600"></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>