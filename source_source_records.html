<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>source_source_records</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="source_source_records_files/libs/clipboard/clipboard.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/quarto.js"></script>
<script src="source_source_records_files/libs/quarto-html/popper.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="source_source_records_files/libs/quarto-html/anchor.min.js"></script>
<link href="source_source_records_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="source_source_records_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="source_source_records_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="source_source_records_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="source_source_records_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<!-- # Source and Source Records {.unnumbered} -->
<section id="general-overview" class="level3">
<h3 class="anchored" data-anchor-id="general-overview">General Overview</h3>
<p>In the data model, a <strong>Source</strong> is a unit that can be observed and provide <strong>Specimens</strong> for analysis or whose observation at time <em>t</em> is used in a diagnostic test (e.g., full <em>Animal</em> for an MRI). <strong>Sources</strong> can provide between zero up (e.g., observation only) to indefinite number of <strong>Specimens</strong> to conduct <strong>Diagnostic</strong> tests. The data model manages four types of <strong>Sources</strong>: i) a co-specific group of animals (<em>Group), ii) individual animals (</em>Animal), iii) sites that can provide abiotic tissue of interest or biotic material of animal origin whose individual or group animal of origin is unknown (<em>Environmental</em>), and iv) sites where arthropods are obtained from (<em>Arthropod</em>). A <strong>Group Source</strong> could correspond to a specific bat roost of species X sourcing guano, an <strong>Animal Source</strong> could be a collared animal, an <strong>Environmental Source</strong> could be a pond where water is collected from or feces found in the field whose animal of origin is unknown, and an <strong>Arthropod Source</strong> could be a site where mosquito larvae are collected from. Sources contain time-independent data only, such as the species of an animal in the case of a <em>Group or </em>Animal Sources (more below).</p>
<p>All <strong>Sources</strong> can potentially be identified and tracked over time if needed. However, there are limitations, <em>Environmental</em> and <em>Arthropod</em> <strong>Sources</strong> are site-specific, making them easier to track across different time points. <em>Animal and </em>Group <strong>Sources</strong> may not always be individually identifiable, which can prevent tracking them over time.</p>
<p><strong>A Source collected, or captured at time <em>t</em> can be linked to Events through a Collection (see previous section) via a Source Record (the Source at time <em>t</em>), which represents the Source at a specific time <em>t<strong>. </strong>Source Records<strong> contain only time-dependent data, such as health status at time <em>t</em> for </strong>Group and </em>Animal Sources</strong>.</p>
<p><strong>Individually identified Sources can tracked across multiple Events, even across different Surveillance Activities</strong>. For example, a bat (<strong>Source</strong>) captured in a mist net (<strong>Collection</strong>) deployed at a roost at time <em>t</em> (<strong>Event</strong>), individually identified, and later recaptured in another <strong>Event</strong> <em>t′</em>. This bat is linked to both the original capture <strong>Event</strong> and the recapture <strong>Event</strong>, with a unique <strong>Source Record</strong> for each occurrence.</p>
<p><strong>Sources that are not identified will be linked as a Source Record to the Event where they were observed or captured only</strong>. For example, a bat (Source) that is captured (Collection) and sampled during an Event but not marked or a dead animal not identified found by a ranger during a patrol. The bat and the animal found are linked only to the Event they were capture and observed, respectively.</p>
<p><strong>Sources found opportunistically are still linked to an Event, even if no formal Collection occurred</strong>. For example, a member of the public reports a dead animal (<strong>Source Record</strong>) found on a beach at time <em>t</em> (<strong>Event</strong>).</p>
</section>
<section id="group-source" class="level3">
<h3 class="anchored" data-anchor-id="group-source">Group Source</h3>
<p><strong>A Group Source is a unit of co-specific individuals (animals of the same species) that are associated with a shared location or entity, such as a herd, area, site, farm, cage, stall, or enclosure, forming a single epidemiological unit</strong>. <strong>Group Sources</strong> can be observed, captured, and provide <strong>Specimens </strong> collectively at a given time <em>t</em> when the <strong>Event</strong> occurs.</p>
<p>Key attributes of a <strong>Group Source</strong> include:</p>
<ul>
<li>Species</li>
<li>Group Source ID</li>
<li>Group Source Cross Reference ID</li>
<li>Collection Cross Reference Origin</li>
</ul>
<p>The primary purpose of a <strong>Group Source</strong> is to record individuals at the species level rather than tracking each one separately. This approach is useful when herds are the unit of interest, when protected area rangers document multiple animals of the same species during a health event, or when animals in a market are grouped in cages or stalls without individual identification. For example, if a single cage contains animals from two different species and they are not tracked individually, they are recorded as two separate <strong>Group Sources</strong>—one per species.</p>
<section id="group-source-record" class="level4">
<h4 class="anchored" data-anchor-id="group-source-record">Group Source Record</h4>
<p><strong>A Group Source Record documents the count of animals within a Group Source at time <em>t</em>, categorized by sex, age, and health status (e.g., healthy, injured, sick, or dead)</strong>. Additional attributes include</p>
<ul>
<li>Observed anomalies</li>
<li>Potential cause of disease</li>
<li>Potential cause of death</li>
</ul>
<p>Since properties of a <strong>Group Source Record</strong> are recorded at the group level, multiple options can be reported for these attributes. For example, if a <strong>Group Source Record</strong> includes three dead animals, several potential causes of death may be listed. However, it is not possible to determine how these potential causes or other properties are distributed across individuals within the <strong>Group Source Record</strong>—only that they were present in at least one individual.</p>
<p>A <strong>Group Source Record can include a mix of dead, diseased, poisoned, infected, injured, and healthy individuals of the same species, or it may consist solely of one category if all individuals share the same status (e.g., all are dead)</strong>. Additionally, even a Group Source Record consisting only of healthy animals can be part of a Health Event, depending on the <strong>Event</strong>’s definition.</p>
<p>A <strong>Group Source Record may contain a single individual</strong>. For example, rangers patrolling a protected area might find one dead animal of species X and two dead animals of species Y at the same site (<strong>Event</strong>), documenting them as separate <strong>Group Source Records</strong> (one group per species). Similarly, if only a single animal from a tracked herd is observed at time <em>t</em>, that individual represents the <strong>Group Source Record</strong> for the herd.</p>
<p>An <strong>Event</strong> can include multiple *<strong>Group Source Records</strong> of the same species. For example, if a vendor at a market keeps animals of the same species in two separate cages, and the <strong>Event</strong> is a vendor, then each cage could be considered a distinct unit. Consequently, there would be two <strong>Group Source Records</strong> for the same species under the same vendor (i.e., within the same <strong>Event</strong>).</p>
<p>A <strong>Group Source</strong> can be directly used for a <strong>Diagnostic</strong> (e.g., assessing the body condition of a specific herd). The data model supports <strong>Diagnostics</strong> applied to an entire group rather than just a <strong>Specimen</strong> taken from that <strong>Group Source</strong>. <strong>Specimens</strong> from <strong>Group Sources</strong> can be stored, exported, and used for <strong>Diagnostics</strong>. However, the data model does not allow <strong>Group Source</strong> carcasses to be exported or stored collectively as a set of carcasses. This is because their collection and handling present an opportunity to gather data at the individual level and recorded as an <strong>Animal Source</strong>. A similar principle applies to <strong>Necropsies</strong> and the <strong>Specimens</strong> collected from carcasses. Carcasses of animals of a <strong>Group Source</strong> collected or taken for Necropsy must be converted into <strong>Animal Sources</strong>. These <strong>Animal Sources</strong> are recorded as former members of the <strong>Group Source</strong> (see the Complexities section for further details).</p>
<p>For similar reasons, <strong>Group Sources</strong> cannot be removed from the field. If dead animals from a <strong>Group Source</strong> are collected, each must be documented as an <strong>Animal Sources</strong> originating from the corresponding <strong>Group Source</strong> whose <strong>Carcass</strong> is taken (see <strong>Animal Sources</strong> and <strong>Carcass</strong> below).</p>
<p>The database does not accept live animals from <strong>Group Sources</strong> be taken ex-situ.</p>
<p>An animal of species X recorded in a <strong>Group Source Record</strong> must not be duplicated as an <strong>Animal Source Record</strong>, and vice versa. If an <strong>Event</strong> contains both a <strong>Group Source Record</strong> and an <strong>Animal Source Record</strong> of species X, the total number of animals of that species in the <strong>Event</strong> is the sum of those in the <strong>Group Source Record</strong> and the individual(s) recorded separately as <strong>Animal Source Record</strong> (e.g., the individuals in the group of animals of species X plus a carcass collected of the same species that would have belonged to the count of dead animals of the <strong>Group Source Record</strong> if not collected).</p>
<p>For example, consider a herd of 20 cows illegally raised in a protected area whose health is assessed at time <em>t</em>. If two cows are sampled, the two sampled cows should be documented as two separate <strong>Animal Source Record</strong> (one per cow), while the remaining 18 cows are recorded as a single <strong>Group Source Record</strong>, categorized by sex, age, and health status. In this scenario, the total number of cows is 20—the 18 recorded in the <strong>Group Source Record</strong> plus the 2 documented as <strong>Animal Source Records</strong>. The “herd” identity of these 20 cows split in three <strong>Source Records</strong> can be maintained using a cluster (see Complexities). If, however, the <strong>Group Source Record</strong> incorrectly includes all 20 cows while two of them are also recorded as <strong>Animal Source Record</strong>, the total count would incorrectly sum to 22, introducing duplication.</p>
</section>
</section>
<section id="animal-source" class="level3">
<h3 class="anchored" data-anchor-id="animal-source">Animal Source</h3>
<p><strong>An Animal Source represents a single individual whose individual-level data is relevant</strong>. <strong>Animal Sources</strong> can be observed, captured, tested, and provide <strong>Specimens </strong>at time <em>t</em>, including full <strong>Carcasses</strong> for <strong>Necropsy</strong>.</p>
<p>Key attributes of a <strong>Animal Source</strong> include:</p>
<ul>
<li>Species</li>
<li>Animal Source ID</li>
<li>Animal Source Cross Reference ID</li>
<li>Sex</li>
</ul>
<p>Any past marking codes assigned to the animal are considered immutable and are recorded as part of the <strong>Animal Source</strong> data.</p>
<p>For example, in a live animal market, if data is collected at the individual level, each animal—whether of the same or different species—must be recorded as a separate <strong>Animal Source</strong>. In contrast, if animals are documented collectively (e.g., by species in a shared cage), they would be classified under a <strong>Group Source</strong> rather than as individual <strong>Animal Sources</strong>.</p>
<section id="animal-source-record" class="level4">
<h4 class="anchored" data-anchor-id="animal-source-record">Animal Source Record</h4>
<p>An <strong>Animal Source Record</strong> represents an individual <strong>Animal Source</strong> at time <em>t</em>.</p>
<p>Key attributes of a <strong>Animal Source</strong> include:</p>
<ul>
<li>Species</li>
<li>Age</li>
<li>Health Status</li>
<li>Observed Anomalies</li>
<li>Potential Causes of Disease or Death</li>
</ul>
<p>The current marking code of an individual animal, if any, at time <em>t</em> is mutable and recorded as a property of the corresponding <strong>Animal Source Record</strong>.</p>
<p>Some properties of an <strong>Animal Source Record</strong> allow single or multiple selections. For instance, an animal’s health status is recorded as one category (e.g., “live healthy” or “live sick”), whereas multiple anomalies may be reported for the same individual at time <em>t</em> (e.g., wounds, hair loss, diarrhea).</p>
<p>An <strong>Animal Source Record</strong> can be categorized as dead, diseased, injured, or healthy at time <em>t</em>. A live, healthy <strong>Animal Source Record can still be part of an </strong>Event<strong>, depending on the Event’s definition</strong> (e.g., a healthy animal of species X observed near dead animals of species X, Y, and Z, or live animals captured for <strong>Specimen</strong> collection).</p>
<p>An <strong>Animal Source Record</strong> can be used directly for a <strong>Diagnostic</strong> (e.g., performing X-rays on a live animal at time <em>t</em>). The data model supports <strong>Diagnostics</strong> applied to the individual itself, rather than only to <strong>Specimens</strong> collected from the animal.</p>
<p>Live <strong>Animal Sources</strong> cannot be removed from the field (ex-situ). Only <strong>Carcasses</strong> of <strong>Animal Sources</strong> can be transported and stored in a facility.</p>
<p>An individual of species X recorded as part of a <strong>Group Source Record</strong> cannot also be included as an <strong>Animal Source Record</strong>, and vice versa. If an <strong>Event</strong> contains both a <strong>Group Source Record</strong> of species X and an <strong>Animal Source Record</strong> of species X, then the total number of animals of species X at the <strong>Event</strong> is the sum of the individuals recorded in the <strong>Group Source Record</strong> and the single individual recorded as an <strong>Animal Source Record</strong>.</p>
<p>For example, consider a herd of 20 cows illegally raised in a protected area, where their health is assessed at time <em>t</em>. If two cows are sampled individually, they are recorded as two separate <strong>Animal Source Record</strong> (one per sampled cow). The remaining 18 cows are documented as one <strong>Group Source Record</strong>, where the total number of individuals is categorized by sex, age, and health status. Thus, the total number of cows at the <strong>Event</strong> is 20 (18 from the <strong>Group Source Record</strong> + 2 from the two <strong>Group Source Records</strong>). To maintain the herd identity, a cluster can be used (see Complexities). If the <strong>Group Source Record</strong> initially included all 20 cows and two additional <strong>Animal Source Record</strong> were created for the sampled individuals, the total number of cows would incorrectly appear as 22—which must be avoided.</p>
</section>
<section id="vaccination" class="level4">
<h4 class="anchored" data-anchor-id="vaccination">Vaccination</h4>
<p>The data model allows the inclusion of vaccinations administered to an <strong>Animal Source</strong> at the time of capture or immobilization <em>t</em>. Multiple vaccination records can be added to an <strong>Animal Source Record</strong> as needed, ensuring that vaccination history accumulates for the corresponding <strong>Animal Source</strong>.</p>
</section>
<section id="carcass" class="level4">
<h4 class="anchored" data-anchor-id="carcass">Carcass</h4>
<p>Each <strong>Carcass</strong> recorded in the database originates from a single <strong>Animal Source</strong> and is collected at a specific time <em>t</em>. Therefore, a <strong>Carcass</strong> is always linked to one, and only one, <strong>Animal Source Record</strong>.</p>
<p>Key attributes of a <strong>Carcass</strong> include:</p>
<ul>
<li>Decomposition Condition</li>
<li>Storage</li>
<li>Storage During Transport</li>
<li>Owner</li>
<li>Availability</li>
</ul>
<p>Carcasses may undergo multiple storage changes over time, including shipments between storage facilities. Any storage updates must occur only after the corresponding exportation is finalized, ensuring the <strong>Carcass</strong> is properly stored at its destination.</p>
<p>Carcasses do not provide <strong>Specimens</strong> directly; rather, <strong>Specimens</strong> are collected through the associated dead <strong>Animal Source Record</strong>. Similarly, a <strong>Carcass</strong> is not directly used for <strong>Diagnostics</strong>—any diagnostic procedures that involve a full carcass, such as X-rays, applied to the corresponding dead <strong>Animal Source Record</strong> and documented accordingly.</p>
</section>
<section id="necropsy" class="level4">
<h4 class="anchored" data-anchor-id="necropsy">Necropsy</h4>
<p>A <strong>Necropsy</strong> is performed on a specific <strong>Animal Source Carcass</strong>. A <strong>Necropsy</strong> can take place is either at the time the dead animal is found and a field necropsy is conducted (without <strong>Carcass</strong> collection) or after the <strong>Carcass</strong> has been collected.</p>
<p>Key attributes of a <strong>Carcass</strong> include:</p>
<ul>
<li>Necropsy Identifier</li>
<li>Necropsy Cross Reference Identifier</li>
<li>Necropsy Date</li>
<li>Findings per system</li>
<li>Availability</li>
</ul>
<p>Necropsies can be classified as primary or secondary. A primary necropsy typically begins with an intact <strong>Carcass</strong> that has not been previously examined. In contrast, a secondary necropsy is usually performed by a veterinary pathologist using either photographs from the primary <strong>Necropsy</strong> or conducting the <strong>Necropsy</strong> again.</p>
<p>A <strong>Necropsy</strong> does not provide <strong>Specimens</strong> directly; rather, <strong>Specimens</strong> are provided through the dead <strong>Animal Source Carcass</strong>.</p>
</section>
</section>
<section id="environmental-source" class="level3">
<h3 class="anchored" data-anchor-id="environmental-source">Environmental Source</h3>
<p><strong>An Environmental Source is a unit in space where Specimens that cannot be associated with a Group Source, an Animal Source, or Arthropod Source can be collected from</strong> (e.g., the site where feces of unknown source are found). Properties of an Environmental Source include the Environmental Source ID, the Cross Reference ID, among others (see Data Dictionary).</p>
<p>Key attributes of a <strong>Environmental Source</strong> include:</p>
<ul>
<li>Environmental Source ID</li>
<li>Environmental Source Cross Reference ID</li>
</ul>
<section id="environmental-source-record" class="level4">
<h4 class="anchored" data-anchor-id="environmental-source-record">Environmental Source Record</h4>
<p>An <strong>Environmental Source Record</strong> represents the biotic or abiotic material collected from an <strong>Environmental Source</strong> at time <em>t</em> using a specific <strong>Collection</strong> method. For example, water sampled from a pond (<strong>Event</strong>) at site X (<strong>Environmental Source</strong>) using a particular device (<strong>Collection</strong>) at time <em>t</em> constitutes an <strong>Environmental Source Record</strong>.</p>
<p>Key attributes of a <strong>Environmental Source Record</strong> include:</p>
<ul>
<li>Environmental Source Record ID</li>
<li>Record Number</li>
<li>Type of Tissue</li>
<li>Quantity</li>
<li>Quantity Unit</li>
</ul>
<p><strong>A key distinction between Environmental Sources and Group or Animal Sources is that multiple Records can be collected from the same Environmental Source within a single Event (e.g., multiple Collections from the same Environmental Source at time <em>t</em>). In contrast, an Event can include only one Record per Group or Animal Source</strong>. An <strong>Event</strong> can contain a single Environmental Source, but multiple Records may be retrieved (one per <strong>Collection</strong>). Conversely, multiple bats captured in a mist net (multiple Sources) can only contribute one <strong>Record</strong> per <strong>Event</strong> (see figure at the end of this section).</p>
<p><strong>Another key distinction is that ‘species’ is a property of the Source for Group and Animal Sources, whereas for Environmental Sources, it is a property of the Record</strong>. For example, feces found in the field may be identified at the taxonomic level of ‘mammal.’ In this case, the species property of the <strong>Environmental Source Record</strong> can be completed accordingly.</p>
<p><strong>If a tissue Collection attempt from an Environmental Source at time t fails, the Collection itself is still recorded, but no Environmental Source Record is created. However, an Environmental Source Record cannot exist without an associated successful Collection</strong></p>
</section>
</section>
<section id="arthropod-source" class="level3">
<h3 class="anchored" data-anchor-id="arthropod-source">Arthropod Source</h3>
<p><strong>An Arthropod Source is a unit in space where arthropods can be taken from</strong> (e.g., a household in the forest where traps can be set). Properties of an Arthropod Source include the Source ID, the Cross Reference ID, the Cross Reference ID Origin, among others (see Data Dictionary).</p>
<p><strong>If the interest of the Surveillance Activity is at the arthropod individual level (e.g., butterflies with problems in their wings or with parasites), then the user should consider these arthropods as Animal Sources. Arthropods from Animals Sources (attached ticks, lice, fleas, mites) are Specimens (see next section) from an Animal Source and not Arthropod Sources</strong>.</p>
<p><strong>An Arthropod Source is a defined spatial unit from which arthropods can be collected</strong> (e.g., a household where traps are set).</p>
<p>Key attributes of a <strong>Arthropod Source</strong> include:</p>
<ul>
<li>Arthropod Source ID</li>
<li>Arthropod Cross Reference ID</li>
</ul>
<p><strong>If the focus of the Surveillance Activity is on individual arthropods (e.g., butterflies with wing deformities or parasitic infestations), they should be considered Animal Sources</strong>.</p>
<p><strong>Arthropods found on Animal Sources (such as attached ticks, lice, fleas, or mites) are considered Specimens collected from the Animal Source rather than independent Arthropod Sources</strong>.</p>
<section id="arthropod-source-record" class="level4">
<h4 class="anchored" data-anchor-id="arthropod-source-record">Arthropod Source Record</h4>
<p><strong>An Arthropod Source Record represents the arthropods collected from an Arthropod Source at time <em>t</em> using a specific Collection method</strong>. For example, mosquitoes at time <em>t</em> (<strong>Arthropod Source Record</strong>) from a household in the forest (<strong>Arthropod Source</strong>) using a CO₂ trap (<strong>Collection</strong>). This means that mosquitoes obtained using CO₂ traps (<strong>Collection</strong>) at an <strong>Arthropod Source</strong> at time <em>t</em> constitute one <strong>Arthropod Source Record</strong>, while mosquitoes collected using BG traps at the same <strong>Event</strong> and is a separate <strong>Arthropod Source Record</strong>.</p>
<p>Key attributes of a <strong>Arthropod Source</strong> include:</p>
<ul>
<li>Arthropod Source Record Number</li>
<li>Arthropod Species</li>
<li>Number by age, sex, and condition (females only)</li>
</ul>
<p><strong>Like Environmental Sources, a key distinction between Arthropod Sources and Group or Animal Sources is that an Event can contain multiple Records from a single Arthropod Source</strong> (many Collections at an Arthropod Source at the same time and place), whereas an <strong>Even</strong>t can only contain a single Record per <strong>Group or Animal Source</strong>. An <strong>Event</strong> can have multiple <strong>Arthropod Source Records</strong> (one per <strong>Collection</strong>). In contrast, if multiple bats are captured in a mist net at time <em>t</em> (many <strong>Sources Records</strong>), they each contribute only one Record per <strong>Event</strong> (see Figure at the end of the section).</p>
<p><strong>Another key difference is that “species” is a property of the Source for Group and Animal Sources, while for Arthropod Sources, several species can be part of the Record and they are assigned at the Source Record level</strong>. For example, mosquitoes collected using CO₂ traps (<strong>Collection</strong>) at a specific site (<strong>Source</strong>) will be identified and counted by species after <strong>Collection</strong>, forming an Arthropod Source Record.</p>
<p>If an arthropod <strong>Collection</strong> attempt at time <em>t</em> fails, the <strong>Collection</strong> itself is recorded, but no <strong>Arthropod Source Record</strong> is created. <strong>An Arthropod Source Record cannot be empty</strong>.</p>
<p><img src="Pictures_and_diagrams/Picture23.png" class="img-fluid" width="600"></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>